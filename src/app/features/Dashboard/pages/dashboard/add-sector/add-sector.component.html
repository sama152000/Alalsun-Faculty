<section class="dashboard-content">
  <div class="management-header">
    <h2>Add New Sector - Basic Info</h2>
  </div>
  <form [formGroup]="sectorForm" (ngSubmit)="saveAndContinue()">
    <div class="tab-content active">
      <div class="form-grid">
        <div class="form-group">
          <label>ID *</label>
          <input 
            type="text" 
            class="form-control" 
            formControlName="id"
            placeholder="Enter sector ID"
          >
        </div>
        <div class="form-group">
          <label>Name *</label>
          <input 
            type="text" 
            class="form-control" 
            formControlName="name"
            placeholder="Enter sector name"
          >
        </div>
        <div class="form-group">
          <label>Title *</label>
          <input 
            type="text" 
            class="form-control" 
            formControlName="title"
            placeholder="Enter title"
          >
        </div>
        <div class="form-group full-width">
          <label>Description *</label>
          <textarea 
            class="form-control" 
            formControlName="description"
            rows="4"
            placeholder="Enter description"
          ></textarea>
        </div>
        <div class="form-group">
          <label>Sector Image *</label>
          <div class="image-preview-section">
            <div class="current-image-preview">
              <img 
                [src]="sectorForm.get('image')?.value || 'https://via.placeholder.com/150'" 
                alt="Sector Image" 
                class="current-image"
              >
            </div>
            <div class="image-selection-section">
              <div class="upload-option">
                <input type="file" #sectorImageInput (change)="onImageFileSelected($event)" 
                       accept="image/*" style="display: none;">
                <button class="upload-btn" (click)="sectorImageInput.click()">
                  <i class="pi pi-upload"></i>
                  <span>Upload New Image</span>
                </button>
              </div>
              <div class="media-gallery-section">
                <button class="btn btn-outline-primary" (click)="openImageModal()">
                  <i class="pi pi-image me-2"></i>
                  Choose from Media Gallery
                </button>
                <div class="media-grid-small" *ngIf="imageMediaItems.length > 0">
                  <div class="media-item-small" 
                       *ngFor="let item of imageMediaItems | slice:0:4"
                       [class.selected]="sectorForm.get('image')?.value === item.url"
                       (click)="sectorForm.get('image')?.setValue(item.url)">
                    <img [src]="item.url" [alt]="item.name" class="media-thumb">
                    <div class="selection-overlay" *ngIf="sectorForm.get('image')?.value === item.url">
                      <i class="pi pi-check"></i>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="form-actions">
      <button 
        type="button"
        class="btn-outline-primary-custom"
        (click)="skipToSectorsManagement()"
      >
        Skip to Sectors Management
      </button>
      <button 
        type="submit"
        class="btn-primary"
        [disabled]="sectorForm.invalid"
      >
        Save and Continue
      </button>
    </div>
  </form>

  <!-- Image Selection Modal -->
  <div class="modal-overlay" *ngIf="showImageModal" (click)="closeImageModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Select Image from Media Gallery</h3>
        <button class="close-btn" (click)="closeImageModal()">
          <i class="pi pi-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="upload-section">
          <input type="file" #modalFileInput (change)="onImageFileSelected($event)" 
                 accept="image/*" style="display: none;">
          <button class="btn btn-primary-gradient" (click)="modalFileInput.click()">
            <i class="pi pi-upload me-2"></i>
            Upload New Image
          </button>
        </div>
        <div class="modal-media-grid">
          <div class="modal-media-item" 
               *ngFor="let item of imageMediaItems"
               [class.selected]="selectedImageUrl === item.url"
               (click)="selectImageFromModal(item.url)">
            <img [src]="item.url" [alt]="item.name" class="modal-media-thumb">
            <div class="selection-overlay" *ngIf="selectedImageUrl === item.url">
              <i class="pi pi-check"></i>
            </div>
            <div class="media-name">{{ item.name }}</div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" (click)="closeImageModal()">
          Cancel
        </button>
        <button class="btn btn-primary-gradient" 
                [disabled]="!selectedImageUrl"
                (click)="confirmImageSelection()">
          <i class="pi pi-check me-2"></i>
          Select Image
        </button>
      </div>
    </div>
  </div>

  <!-- Upload Progress -->
  <div class="upload-progress" *ngIf="isUploading">
    <div class="progress-card">
      <div class="progress-header">
        <h4>Uploading Image...</h4>
        <span>{{ uploadProgress }}%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="uploadProgress"></div>
      </div>
    </div>
  </div>

  <!-- Toast Messages -->
  <div class="toast-container" *ngIf="showToast">
    <div class="toast" [ngClass]="toastClass">
      <div class="toast-content">
        <i [ngClass]="toastIcon"></i>
        <span>{{ toastMessage }}</span>
      </div>
      <button class="toast-close" (click)="hideToast()">
        <i class="pi pi-times"></i>
      </button>
    </div>
  </div>
</section>