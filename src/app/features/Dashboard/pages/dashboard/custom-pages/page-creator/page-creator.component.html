<div class="page-creator-container">
  <div class="creator-header">
    <h2>Create New Page</h2>
    <p>Template: {{ getTemplateName() }}</p>
  </div>

  <form [formGroup]="pageForm" (ngSubmit)="onSubmit()">
    <div class="form-sections">
      <!-- Basic Information -->
      <div class="form-section">
        <h3>Basic Information</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>Page Title *</label>
            <input 
              type="text" 
              formControlName="title"
              placeholder="Enter page title"
              class="form-control"
            >
            <div *ngIf="pageForm.get('title')?.invalid && (pageForm.get('title')?.dirty || pageForm.get('title')?.touched)" class="error-message">
              Page Title is required
            </div>
          </div>
          <div class="form-group">
            <label>Page Route *</label>
            <input 
              type="text" 
              formControlName="route"
              placeholder="e.g., my-custom-page"
              class="form-control"
            >
            <div *ngIf="pageForm.get('route')?.invalid && (pageForm.get('route')?.dirty || pageForm.get('route')?.touched)" class="error-message">
              <span *ngIf="pageForm.get('route')?.errors?.['required']">Page Route is required</span>
              <span *ngIf="pageForm.get('route')?.errors?.['pattern']">Route must contain only letters, numbers, hyphens, or underscores</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Content Based on Template -->
      <div class="form-section" formGroupName="content">
        <h3>Page Content</h3>
        
        <!-- Title & Text Template -->
        <div *ngIf="templateId === 'title-text'" class="template-form">
          <div class="form-group">
            <label>Main Title *</label>
            <input 
              type="text" 
              formControlName="title"
              placeholder="Enter main title"
              class="form-control"
            >
            <div *ngIf="pageForm.get('content.title')?.invalid && (pageForm.get('content.title')?.dirty || pageForm.get('content.title')?.touched)" class="error-message">
              Main Title is required
            </div>
          </div>
          <div class="form-group">
            <label>Content Text *</label>
            <textarea 
              formControlName="text"
              rows="8"
              placeholder="Enter your content here..."
              class="form-control"
            ></textarea>
            <div *ngIf="pageForm.get('content.text')?.invalid && (pageForm.get('content.text')?.dirty || pageForm.get('content.text')?.touched)" class="error-message">
              Content Text is required
            </div>
          </div>
        </div>

        <!-- Image, Title & Text Template -->
        <div *ngIf="templateId === 'image-title-text'" class="template-form">
          <div class="form-group">
            <label>Main Title *</label>
            <input 
              type="text" 
              formControlName="title"
              placeholder="Enter main title"
              class="form-control"
            >
            <div *ngIf="pageForm.get('content.title')?.invalid && (pageForm.get('content.title')?.dirty || pageForm.get('content.title')?.touched)" class="error-message">
              Main Title is required
            </div>
          </div>
          <div class="form-group">
            <label>Image URL *</label>
            <input 
              type="url" 
              formControlName="image"
              placeholder="Enter image URL"
              class="form-control"
            >
            <div *ngIf="pageForm.get('content.image')?.invalid && (pageForm.get('content.image')?.dirty || pageForm.get('content.image')?.touched)" class="error-message">
              Image URL is required
            </div>
          </div>
          <div class="form-group">
            <label>Content Text *</label>
            <textarea 
              formControlName="text"
              rows="6"
              placeholder="Enter your content here..."
              class="form-control"
            ></textarea>
            <div *ngIf="pageForm.get('content.text')?.invalid && (pageForm.get('content.text')?.dirty || pageForm.get('content.text')?.touched)" class="error-message">
              Content Text is required
            </div>
          </div>
        </div>

        <!-- Cards Template -->
        <div *ngIf="templateId === 'cards'" class="template-form">
          <div class="form-group">
            <label>Section Title *</label>
            <input 
              type="text" 
              formControlName="title"
              placeholder="Enter section title"
              class="form-control"
            >
            <div *ngIf="pageForm.get('content.title')?.invalid && (pageForm.get('content.title')?.dirty || pageForm.get('content.title')?.touched)" class="error-message">
              Section Title is required
            </div>
          </div>
          
          <div class="cards-section">
            <div class="section-header">
              <h4>Content Cards</h4>
              <button 
                type="button"
                class="btn-add-card"
                (click)="addCard()"
              >
                <i class="pi pi-plus"></i>
                Add Card
              </button>
            </div>
            
            <div formArrayName="cards">
              <div 
                *ngFor="let card of cardsArray.controls; let i = index"
                [formGroupName]="i"
                class="card-form"
              >
                <div class="card-header">
                  <h5>Card {{ i + 1 }}</h5>
                  <button 
                    type="button"
                    class="btn-remove-card"
                    (click)="removeCard(i)"
                  >
                    <i class="pi pi-trash"></i>
                  </button>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label>Card Title</label>
                    <input 
                      type="text" 
                      formControlName="title"
                      placeholder="Enter card title"
                      class="form-control"
                    >
                    <div *ngIf="cardsArray.controls[i].get('title')?.invalid && (cardsArray.controls[i].get('title')?.dirty || cardsArray.controls[i].get('title')?.touched)" class="error-message">
                      Card Title is required
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Card Link (optional)</label>
                    <input 
                      type="text" 
                      formControlName="link"
                      placeholder="Enter link URL"
                      class="form-control"
                    >
                  </div>
                  <div class="form-group full-width">
                    <label>Card Description</label>
                    <textarea 
                      formControlName="description"
                      rows="3"
                      placeholder="Enter card description"
                      class="form-control"
                    ></textarea>
                    <div *ngIf="cardsArray.controls[i].get('description')?.invalid && (cardsArray.controls[i].get('description')?.dirty || cardsArray.controls[i].get('description')?.touched)" class="error-message">
                      Card Description is required
                    </div>
                  </div>
                  <div class="form-group full-width">
                    <label>Card Image URL (optional)</label>
                    <input 
                      type="url" 
                      formControlName="image"
                      placeholder="Enter image URL"
                      class="form-control"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button 
        type="button"
        class="btn-outline-primary-custom"
        (click)="goBack()"
      >
        <i class="pi pi-arrow-left"></i>
        Back
      </button>
      <button 
        type="submit"
        class="btn-primary-custom"
        [disabled]="pageForm.invalid"
      >
        <i class="pi pi-eye"></i>
        Preview Page
      </button>
    </div>
  </form>
</div>